!function(n,e){for(var t in e)n[t]=e[t]}(exports,function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=6)}([function(n,e){n.exports=require("domain")},function(n,e,t){var r;r=t(0),e.context=function(n,e){if(null==e&&(e=r.active),null==e)throw new Error("no active domain");return e.__context__=null!=n?n():{}},e.cleanup=function(n,e,t){if(null==e&&(e=null),null==t&&(t=r.active),e=e||t.__context__,null!=n&&null!=e&&n(e),null!=t)return t.__context__=null},e.onError=function(n,e,t,o){return null==t&&(t=null),null==o&&(o=r.active),t=t||o.__context__,null!=e&&e(n,t),o.__context__=null},e.get=function(n,e){if(null==e&&(e=r.active),null==e)throw new Error("no active domain");return e.__context__[n]},e.set=function(n,e,t){if(null==t&&(t=r.active),null==t)throw new Error("no active domain");return t.__context__[n]=e},e.run=function(n,t){var o,u,i,c,a;if(t||(t=n,n={}),u=n.context,o=n.cleanup,a=n.onError,!(i=n.domain||r.active))throw new Error("no active domain");i.on("dispose",function(){return e.cleanup(o,null,i)}),i.on("error",function(n){return null!=a?e.onError(n,a,null,i):e.cleanup(o,null,i)}),e.context(u,i);try{i.bind(t,!0)()}catch(n){c=n,i.emit("error",c)}return i},e.runInNewDomain=function(n,t){var o;return t||(t=n,n={}),o=r.active,n.domain=r.create(),!n.detach&&o&&(o.add(n.domain),n.domain.on("error",function(n){return o.emit("error",n)}),o.on("dispose",function(){return n.domain.dispose()})),e.run(n,t)},e.middleware=function(n,t){return function(o,u,i){var c,a;return"function"!=typeof n&&(n=(a=n).context,t=a.cleanup),c=r.active,e.context(n,c),u.on("finish",function(){return e.cleanup(t,null,c)}),o.__context__=c.__context__,i()}},e.middlewareOnError=function(n){return function(t,r,o,u){return"function"!=typeof n&&(n=n.onError),null!=n?e.onError(t,n,r.__context__):e.cleanup(n,r.__context__),r.__context__=null,u(t)}}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=t(0),u=t(1),i="__DOMAIN_TASKS",c="__DOMAIN_TASK_INTERNAL_FETCH_BASEURL__DO_NOT_REFERENCE_THIS__";e.addTask=function(n){if(n&&o.active){var e=u.get(i);e&&(e.numRemainingTasks++,n.then(function(){setTimeout(function(){e.numRemainingTasks--,0!==e.numRemainingTasks||e.hasIssuedSuccessCallback||(e.hasIssuedSuccessCallback=!0,setTimeout(function(){e.completionCallback(null)},0))},0)},function(n){e.completionCallback(n)}))}},e.run=function(n,e){var t;return u.runInNewDomain(function(){var r={numRemainingTasks:0,hasIssuedSuccessCallback:!1,completionCallback:o.active.bind(e)};try{u.set(i,r),t=n(),0!==r.numRemainingTasks||r.hasIssuedSuccessCallback||(r.hasIssuedSuccessCallback=!0,setTimeout(function(){r.completionCallback(null)},0))}catch(n){r.completionCallback(n)}}),t},e.baseUrl=function(n){return n&&(o.active?u.set(c,n):r=n),o.active?u.get(c):r}},function(n,e){n.exports=require("url")},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t(3),o=t(0),u=t(2),i=3e4;e.createServerRenderer=function(n){var e=function(e,t,c,a,l,s,f,d){var _,m=new Promise(function(n,e){_=n}),p=r.parse(a),v={location:r.parse(l,!0),origin:p.protocol+"//"+p.host,url:l,baseUrl:(d||"")+"/",absoluteUrl:a,domainTasks:m,data:s},b=v.origin+v.baseUrl;u.run(function(){!function(n,e){var t=n.then;n.then=function(n,r){return"function"==typeof n&&(n=e.bind(n)),"function"==typeof r&&(r=e.bind(r)),t.call(this,n,r)}}(m,o.active),u.baseUrl(b);var t=n(v);if(t&&"function"==typeof t.then){var r=f||i;(r>0?function(n,e,t){return new Promise(function(r,o){var u=setTimeout(function(){o(t)},e);n.then(function(n){clearTimeout(u),r(n)},function(n){clearTimeout(u),o(n)})})}(t,r,"Prerendering timed out after "+r+"ms because the boot function in '"+c.moduleName+"' returned a promise that did not resolve or reject. Make sure that your boot function always resolves or rejects its promise. You can change the timeout value using the 'asp-prerender-timeout' tag helper."):t).then(function(n){e(null,n)},function(n){e(n,null)})}else e("Prerendering failed because the boot function in "+c.moduleName+" did not return a promise.",null)},function(n){n?e(n,null):_()})};return e.isServerRenderer=!0,e}},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){for(var t in n)e.hasOwnProperty(t)||(e[t]=n[t])}(t(4))},function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t(5);e.default=r.createServerRenderer(function(n){return new Promise(function(e,t){e({html:"<h1>Hello world, from JS!</h1>\n            <p>Current time in node: "+new Date+"</p>\n            <p>URL: "+n.location.path+"</p>\n            <p>data (IsAdministrator): "+n.data.isAdministrator+"</p>\n            <p>Number of cookies: "+n.data.cookies.length+"</p>\n            "})})})}]));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiZG9tYWluXCIiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2RvbWFpbi1jb250ZXh0L2xpYi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZG9tYWluLXRhc2svbWFpbi5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1cmxcIiIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXNwbmV0LXByZXJlbmRlcmluZy9QcmVyZW5kZXJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2FzcG5ldC1wcmVyZW5kZXJpbmcvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vQ2xpZW50QXBwL2Jvb3Qtc2VydmVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicmVxdWlyZSIsImRvbWFpbiIsImNvbnRleHQiLCJjdXJyZW50RG9tYWluIiwiYWN0aXZlIiwiRXJyb3IiLCJfX2NvbnRleHRfXyIsImNsZWFudXAiLCJvbkVycm9yIiwiZXJyIiwic2V0IiwicnVuIiwib3B0aW9ucyIsImZ1bmMiLCJvbiIsIl9lcnJvciIsImVtaXQiLCJydW5Jbk5ld0RvbWFpbiIsImRldGFjaCIsImFkZCIsImRpc3Bvc2UiLCJtaWRkbGV3YXJlIiwicmVxIiwicmVzIiwibmV4dCIsIl9yZWYiLCJtaWRkbGV3YXJlT25FcnJvciIsIm5vRG9tYWluQmFzZVVybCIsImRvbWFpbkNvbnRleHQiLCJkb21haW5UYXNrc1N0YXRlS2V5IiwiZG9tYWluVGFza0Jhc2VVcmxTdGF0ZUtleSIsImFkZFRhc2siLCJ0YXNrIiwic3RhdGVfMSIsIm51bVJlbWFpbmluZ1Rhc2tzIiwidGhlbiIsInNldFRpbWVvdXQiLCJoYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2siLCJjb21wbGV0aW9uQ2FsbGJhY2siLCJlcnJvciIsImNvZGVUb1J1biIsInN5bmNocm9ub3VzUmVzdWx0Iiwic3RhdGUiLCJleCIsImJhc2VVcmwiLCJ1cmwiLCJtYWluXzEiLCJkZWZhdWx0VGltZW91dE1pbGxpc2Vjb25kcyIsImNyZWF0ZVNlcnZlclJlbmRlcmVyIiwiYm9vdEZ1bmMiLCJyZXN1bHRGdW5jIiwiY2FsbGJhY2siLCJhcHBsaWNhdGlvbkJhc2VQYXRoIiwiYm9vdE1vZHVsZSIsImFic29sdXRlUmVxdWVzdFVybCIsInJlcXVlc3RQYXRoQW5kUXVlcnkiLCJjdXN0b21EYXRhUGFyYW1ldGVyIiwib3ZlcnJpZGVUaW1lb3V0TWlsbGlzZWNvbmRzIiwicmVxdWVzdFBhdGhCYXNlIiwiZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlUmVzb2x2ZSIsImRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicGFyc2VkQWJzb2x1dGVSZXF1ZXN0VXJsIiwicGFyc2UiLCJwYXJhbXMiLCJsb2NhdGlvbiIsIm9yaWdpbiIsInByb3RvY29sIiwiaG9zdCIsImFic29sdXRlVXJsIiwiZG9tYWluVGFza3MiLCJkYXRhIiwiYWJzb2x1dGVCYXNlVXJsIiwicHJvbWlzZSIsImRvbWFpbkluc3RhbmNlIiwib3JpZ2luYWxUaGVuIiwidGhpcyIsImJpbmRQcm9taXNlQ29udGludWF0aW9uc1RvRG9tYWluIiwiYm9vdEZ1bmNQcm9taXNlIiwidGltZW91dE1pbGxpc2Vjb25kcyIsInRpbWVvdXRSZWplY3Rpb25WYWx1ZSIsInRpbWVvdXRUaW1lciIsInJlc29sdmVkVmFsdWUiLCJjbGVhclRpbWVvdXQiLCJyZWplY3RlZFZhbHVlIiwid3JhcFdpdGhUaW1lb3V0IiwibW9kdWxlTmFtZSIsInN1Y2Nlc3NSZXN1bHQiLCJlcnJvck9yTm90aGluZyIsIl9fZXhwb3J0IiwiYXNwbmV0X3ByZXJlbmRlcmluZ18xIiwiZGVmYXVsdCIsImh0bWwiLCJEYXRlIiwicGF0aCIsImlzQWRtaW5pc3RyYXRvciIsImNvb2tpZXMiLCJsZW5ndGgiXSwibWFwcGluZ3MiOiI2REFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBMERBLE9BckRBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFB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QSxjQUE4Q21CLE9BQUEsSUFIOUMsU0FBQWIsR0FDQSxRQUFBMEIsS0FBQTFCLEVBQUFOLEVBQUErQixlQUFBQyxLQUFBaEMsRUFBQWdDLEdBQUExQixFQUFBMEIsSUFHQTZGLENBQUEvSCxFQUFBLG1GQ0xBLElBQUFnSSxFQUFBaEksRUFBQSxHQUVBRSxFQUFBK0gsUUFBZUQsRUFBQTVDLHFCQUFxQixTQUFBa0IsR0FDaEMsT0FBTyxJQUFJTCxRQUFRLFNBQVVDLEVBQVNDLEdBT2xDRCxHQUFVZ0MsS0FORyx3RUFDbUIsSUFBSUMsS0FBTSw2QkFDNUI3QixFQUFPQyxTQUFTNkIsS0FBSSxnREFDRDlCLEVBQU9PLEtBQUt3QixnQkFBZSwyQ0FDaEMvQixFQUFPTyxLQUFLeUIsUUFBUUMsT0FBTSIsImZpbGUiOiJtYWluLXNlcnZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA2KTtcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvbWFpblwiKTsiLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4yXG52YXIgZG9tYWluO1xuXG5kb21haW4gPSByZXF1aXJlKCdkb21haW4nKTtcblxuZXhwb3J0cy5jb250ZXh0ID0gZnVuY3Rpb24oY29udGV4dCwgY3VycmVudERvbWFpbikge1xuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgaWYgKGN1cnJlbnREb21haW4gPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbm8gYWN0aXZlIGRvbWFpbicpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fID0gY29udGV4dCAhPSBudWxsID8gY29udGV4dCgpIDoge307XG59O1xuXG5leHBvcnRzLmNsZWFudXAgPSBmdW5jdGlvbihjbGVhbnVwLCBjb250ZXh0LCBjdXJyZW50RG9tYWluKSB7XG4gIGlmIChjb250ZXh0ID09IG51bGwpIHtcbiAgICBjb250ZXh0ID0gbnVsbDtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgY29udGV4dCA9IGNvbnRleHQgfHwgY3VycmVudERvbWFpbi5fX2NvbnRleHRfXztcbiAgaWYgKChjbGVhbnVwICE9IG51bGwpICYmIChjb250ZXh0ICE9IG51bGwpKSB7XG4gICAgY2xlYW51cChjb250ZXh0KTtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGN1cnJlbnREb21haW4uX19jb250ZXh0X18gPSBudWxsO1xuICB9XG59O1xuXG5leHBvcnRzLm9uRXJyb3IgPSBmdW5jdGlvbihlcnIsIG9uRXJyb3IsIGNvbnRleHQsIGN1cnJlbnREb21haW4pIHtcbiAgaWYgKGNvbnRleHQgPT0gbnVsbCkge1xuICAgIGNvbnRleHQgPSBudWxsO1xuICB9XG4gIGlmIChjdXJyZW50RG9tYWluID09IG51bGwpIHtcbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgfVxuICBjb250ZXh0ID0gY29udGV4dCB8fCBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fO1xuICBpZiAob25FcnJvciAhPSBudWxsKSB7XG4gICAgb25FcnJvcihlcnIsIGNvbnRleHQpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fID0gbnVsbDtcbn07XG5cbmV4cG9ydHMuZ2V0ID0gZnVuY3Rpb24oa2V5LCBjdXJyZW50RG9tYWluKSB7XG4gIGlmIChjdXJyZW50RG9tYWluID09IG51bGwpIHtcbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgfVxuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdubyBhY3RpdmUgZG9tYWluJyk7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnREb21haW4uX19jb250ZXh0X19ba2V5XTtcbn07XG5cbmV4cG9ydHMuc2V0ID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSwgY3VycmVudERvbWFpbikge1xuICBpZiAoY3VycmVudERvbWFpbiA9PSBudWxsKSB7XG4gICAgY3VycmVudERvbWFpbiA9IGRvbWFpbi5hY3RpdmU7XG4gIH1cbiAgaWYgKGN1cnJlbnREb21haW4gPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbm8gYWN0aXZlIGRvbWFpbicpO1xuICB9XG4gIHJldHVybiBjdXJyZW50RG9tYWluLl9fY29udGV4dF9fW2tleV0gPSB2YWx1ZTtcbn07XG5cbmV4cG9ydHMucnVuID0gZnVuY3Rpb24ob3B0aW9ucywgZnVuYykge1xuICB2YXIgY2xlYW51cCwgY29udGV4dCwgY3VycmVudERvbWFpbiwgZXJyLCBvbkVycm9yO1xuXG4gIGlmICghZnVuYykge1xuICAgIGZ1bmMgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuICBjb250ZXh0ID0gb3B0aW9ucy5jb250ZXh0LCBjbGVhbnVwID0gb3B0aW9ucy5jbGVhbnVwLCBvbkVycm9yID0gb3B0aW9ucy5vbkVycm9yO1xuICBjdXJyZW50RG9tYWluID0gb3B0aW9ucy5kb21haW4gfHwgZG9tYWluLmFjdGl2ZTtcbiAgaWYgKCFjdXJyZW50RG9tYWluKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdubyBhY3RpdmUgZG9tYWluJyk7XG4gIH1cbiAgY3VycmVudERvbWFpbi5vbignZGlzcG9zZScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBleHBvcnRzLmNsZWFudXAoY2xlYW51cCwgbnVsbCwgY3VycmVudERvbWFpbik7XG4gIH0pO1xuICBjdXJyZW50RG9tYWluLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xuICAgIGlmIChvbkVycm9yICE9IG51bGwpIHtcbiAgICAgIHJldHVybiBleHBvcnRzLm9uRXJyb3IoZXJyLCBvbkVycm9yLCBudWxsLCBjdXJyZW50RG9tYWluKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGV4cG9ydHMuY2xlYW51cChjbGVhbnVwLCBudWxsLCBjdXJyZW50RG9tYWluKTtcbiAgICB9XG4gIH0pO1xuICBleHBvcnRzLmNvbnRleHQoY29udGV4dCwgY3VycmVudERvbWFpbik7XG4gIHRyeSB7XG4gICAgY3VycmVudERvbWFpbi5iaW5kKGZ1bmMsIHRydWUpKCk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIGVyciA9IF9lcnJvcjtcbiAgICBjdXJyZW50RG9tYWluLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgfVxuICByZXR1cm4gY3VycmVudERvbWFpbjtcbn07XG5cbmV4cG9ydHMucnVuSW5OZXdEb21haW4gPSBmdW5jdGlvbihvcHRpb25zLCBmdW5jKSB7XG4gIHZhciBjdXJyZW50RG9tYWluO1xuXG4gIGlmICghZnVuYykge1xuICAgIGZ1bmMgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgb3B0aW9ucy5kb21haW4gPSBkb21haW4uY3JlYXRlKCk7XG4gIGlmICghb3B0aW9ucy5kZXRhY2ggJiYgY3VycmVudERvbWFpbikge1xuICAgIGN1cnJlbnREb21haW4uYWRkKG9wdGlvbnMuZG9tYWluKTtcbiAgICBvcHRpb25zLmRvbWFpbi5vbignZXJyb3InLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgIHJldHVybiBjdXJyZW50RG9tYWluLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICB9KTtcbiAgICBjdXJyZW50RG9tYWluLm9uKCdkaXNwb3NlJywgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5kb21haW4uZGlzcG9zZSgpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBleHBvcnRzLnJ1bihvcHRpb25zLCBmdW5jKTtcbn07XG5cbmV4cG9ydHMubWlkZGxld2FyZSA9IGZ1bmN0aW9uKGNvbnRleHQsIGNsZWFudXApIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdmFyIGN1cnJlbnREb21haW4sIF9yZWY7XG5cbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIF9yZWYgPSBjb250ZXh0LCBjb250ZXh0ID0gX3JlZi5jb250ZXh0LCBjbGVhbnVwID0gX3JlZi5jbGVhbnVwO1xuICAgIH1cbiAgICBjdXJyZW50RG9tYWluID0gZG9tYWluLmFjdGl2ZTtcbiAgICBleHBvcnRzLmNvbnRleHQoY29udGV4dCwgY3VycmVudERvbWFpbik7XG4gICAgcmVzLm9uKCdmaW5pc2gnLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBleHBvcnRzLmNsZWFudXAoY2xlYW51cCwgbnVsbCwgY3VycmVudERvbWFpbik7XG4gICAgfSk7XG4gICAgcmVxLl9fY29udGV4dF9fID0gY3VycmVudERvbWFpbi5fX2NvbnRleHRfXztcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9O1xufTtcblxuZXhwb3J0cy5taWRkbGV3YXJlT25FcnJvciA9IGZ1bmN0aW9uKG9uRXJyb3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGVyciwgcmVxLCByZXMsIG5leHQpIHtcbiAgICBpZiAodHlwZW9mIG9uRXJyb3IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIG9uRXJyb3IgPSBvbkVycm9yLm9uRXJyb3I7XG4gICAgfVxuICAgIGlmIChvbkVycm9yICE9IG51bGwpIHtcbiAgICAgIGV4cG9ydHMub25FcnJvcihlcnIsIG9uRXJyb3IsIHJlcS5fX2NvbnRleHRfXyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cG9ydHMuY2xlYW51cChvbkVycm9yLCByZXEuX19jb250ZXh0X18pO1xuICAgIH1cbiAgICByZXEuX19jb250ZXh0X18gPSBudWxsO1xuICAgIHJldHVybiBuZXh0KGVycik7XG4gIH07XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIGRvbWFpbiA9IHJlcXVpcmUoXCJkb21haW5cIik7XHJcbnZhciBkb21haW5Db250ZXh0ID0gcmVxdWlyZShcImRvbWFpbi1jb250ZXh0XCIpO1xyXG4vLyBOb3QgdXNpbmcgc3ltYm9scywgYmVjYXVzZSB0aGlzIG1heSBuZWVkIHRvIHJ1biBpbiBhIHZlcnNpb24gb2YgTm9kZS5qcyB0aGF0IGRvZXNuJ3Qgc3VwcG9ydCB0aGVtXHJcbnZhciBkb21haW5UYXNrc1N0YXRlS2V5ID0gJ19fRE9NQUlOX1RBU0tTJztcclxudmFyIGRvbWFpblRhc2tCYXNlVXJsU3RhdGVLZXkgPSAnX19ET01BSU5fVEFTS19JTlRFUk5BTF9GRVRDSF9CQVNFVVJMX19ET19OT1RfUkVGRVJFTkNFX1RISVNfXyc7XHJcbnZhciBub0RvbWFpbkJhc2VVcmw7XHJcbmZ1bmN0aW9uIGFkZFRhc2sodGFzaykge1xyXG4gICAgaWYgKHRhc2sgJiYgZG9tYWluLmFjdGl2ZSkge1xyXG4gICAgICAgIHZhciBzdGF0ZV8xID0gZG9tYWluQ29udGV4dC5nZXQoZG9tYWluVGFza3NTdGF0ZUtleSk7XHJcbiAgICAgICAgaWYgKHN0YXRlXzEpIHtcclxuICAgICAgICAgICAgc3RhdGVfMS5udW1SZW1haW5pbmdUYXNrcysrO1xyXG4gICAgICAgICAgICB0YXNrLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhlIGFwcGxpY2F0aW9uIG1heSBoYXZlIG90aGVyIGxpc3RlbmVycyBjaGFpbmVkIHRvIHRoaXMgcHJvbWlzZSAqYWZ0ZXIqXHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGxpc3RlbmVyLCB3aGljaCBtYXkgaW4gdHVybiByZWdpc3RlciBmdXJ0aGVyIHRhc2tzLiBTaW5jZSB3ZSBkb24ndCBcclxuICAgICAgICAgICAgICAgIC8vIHdhbnQgdGhlIGNvbWJpbmVkIHRhc2sgdG8gY29tcGxldGUgdW50aWwgYWxsIHRoZSBoYW5kbGVycyBmb3IgY2hpbGQgdGFza3NcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgZmluaXNoZWQsIGRlbGF5IHRoZSByZXNwb25zZSB0byBnaXZlIHRpbWUgZm9yIG1vcmUgdGFza3MgdG8gYmUgYWRkZWRcclxuICAgICAgICAgICAgICAgIC8vIHN5bmNocm9ub3VzbHkuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZV8xLm51bVJlbWFpbmluZ1Rhc2tzLS07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlXzEubnVtUmVtYWluaW5nVGFza3MgPT09IDAgJiYgIXN0YXRlXzEuaGFzSXNzdWVkU3VjY2Vzc0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlXzEuaGFzSXNzdWVkU3VjY2Vzc0NhbGxiYWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZV8xLmNvbXBsZXRpb25DYWxsYmFjaygvKiBlcnJvciAqLyBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgc3RhdGVfMS5jb21wbGV0aW9uQ2FsbGJhY2soZXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5hZGRUYXNrID0gYWRkVGFzaztcclxuZnVuY3Rpb24gcnVuKGNvZGVUb1J1biwgY29tcGxldGlvbkNhbGxiYWNrKSB7XHJcbiAgICB2YXIgc3luY2hyb25vdXNSZXN1bHQ7XHJcbiAgICBkb21haW5Db250ZXh0LnJ1bkluTmV3RG9tYWluKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIG51bVJlbWFpbmluZ1Rhc2tzOiAwLFxyXG4gICAgICAgICAgICBoYXNJc3N1ZWRTdWNjZXNzQ2FsbGJhY2s6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb21wbGV0aW9uQ2FsbGJhY2s6IGRvbWFpbi5hY3RpdmUuYmluZChjb21wbGV0aW9uQ2FsbGJhY2spXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBkb21haW5Db250ZXh0LnNldChkb21haW5UYXNrc1N0YXRlS2V5LCBzdGF0ZSk7XHJcbiAgICAgICAgICAgIHN5bmNocm9ub3VzUmVzdWx0ID0gY29kZVRvUnVuKCk7XHJcbiAgICAgICAgICAgIC8vIElmIG5vIHRhc2tzIHdlcmUgcmVnaXN0ZXJlZCBzeW5jaHJvbm91c2x5LCB0aGVuIHdlJ3JlIGRvbmUgYWxyZWFkeVxyXG4gICAgICAgICAgICBpZiAoc3RhdGUubnVtUmVtYWluaW5nVGFza3MgPT09IDAgJiYgIXN0YXRlLmhhc0lzc3VlZFN1Y2Nlc3NDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgc3RhdGUuaGFzSXNzdWVkU3VjY2Vzc0NhbGxiYWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmNvbXBsZXRpb25DYWxsYmFjaygvKiBlcnJvciAqLyBudWxsKTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICBzdGF0ZS5jb21wbGV0aW9uQ2FsbGJhY2soZXgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHN5bmNocm9ub3VzUmVzdWx0O1xyXG59XHJcbmV4cG9ydHMucnVuID0gcnVuO1xyXG5mdW5jdGlvbiBiYXNlVXJsKHVybCkge1xyXG4gICAgaWYgKHVybCkge1xyXG4gICAgICAgIGlmIChkb21haW4uYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZXJlJ3MgYW4gYWN0aXZlIGRvbWFpbiAoZS5nLiwgaW4gTm9kZS5qcyksIHNvIGFzc29jaWF0ZSB0aGUgYmFzZSBVUkwgd2l0aCBpdFxyXG4gICAgICAgICAgICBkb21haW5Db250ZXh0LnNldChkb21haW5UYXNrQmFzZVVybFN0YXRlS2V5LCB1cmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUncyBubyBhY3RpdmUgZG9tYWluIChlLmcuLCBpbiBicm93c2VyKSwgc28gdGhlcmUncyBqdXN0IG9uZSBzaGFyZWQgYmFzZSBVUkxcclxuICAgICAgICAgICAgbm9Eb21haW5CYXNlVXJsID0gdXJsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBkb21haW4uYWN0aXZlID8gZG9tYWluQ29udGV4dC5nZXQoZG9tYWluVGFza0Jhc2VVcmxTdGF0ZUtleSkgOiBub0RvbWFpbkJhc2VVcmw7XHJcbn1cclxuZXhwb3J0cy5iYXNlVXJsID0gYmFzZVVybDtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidXJsXCIpOyIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbnZhciB1cmwgPSByZXF1aXJlKFwidXJsXCIpO1xyXG52YXIgZG9tYWluID0gcmVxdWlyZShcImRvbWFpblwiKTtcclxudmFyIG1haW5fMSA9IHJlcXVpcmUoXCJkb21haW4tdGFzay9tYWluXCIpO1xyXG52YXIgZGVmYXVsdFRpbWVvdXRNaWxsaXNlY29uZHMgPSAzMCAqIDEwMDA7XHJcbmZ1bmN0aW9uIGNyZWF0ZVNlcnZlclJlbmRlcmVyKGJvb3RGdW5jKSB7XHJcbiAgICB2YXIgcmVzdWx0RnVuYyA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYXBwbGljYXRpb25CYXNlUGF0aCwgYm9vdE1vZHVsZSwgYWJzb2x1dGVSZXF1ZXN0VXJsLCByZXF1ZXN0UGF0aEFuZFF1ZXJ5LCBjdXN0b21EYXRhUGFyYW1ldGVyLCBvdmVycmlkZVRpbWVvdXRNaWxsaXNlY29uZHMsIHJlcXVlc3RQYXRoQmFzZSkge1xyXG4gICAgICAgIC8vIFByZXBhcmUgYSBwcm9taXNlIHRoYXQgd2lsbCByZXByZXNlbnQgdGhlIGNvbXBsZXRpb24gb2YgYWxsIGRvbWFpbiB0YXNrcyBpbiB0aGlzIGV4ZWN1dGlvbiBjb250ZXh0LlxyXG4gICAgICAgIC8vIFRoZSBib290IGNvZGUgd2lsbCB3YWl0IGZvciB0aGlzIGJlZm9yZSBwZXJmb3JtaW5nIGl0cyBmaW5hbCByZW5kZXIuXHJcbiAgICAgICAgdmFyIGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZVJlc29sdmU7XHJcbiAgICAgICAgdmFyIGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlUmVzb2x2ZSA9IHJlc29sdmU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHBhcnNlZEFic29sdXRlUmVxdWVzdFVybCA9IHVybC5wYXJzZShhYnNvbHV0ZVJlcXVlc3RVcmwpO1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIC8vIEl0J3MgaGVscGZ1bCBmb3IgYm9vdCBmdW5jcyB0byByZWNlaXZlIHRoZSBxdWVyeSBhcyBhIGtleS12YWx1ZSBvYmplY3QsIHNvIHBhcnNlIGl0IGhlcmVcclxuICAgICAgICAgICAgLy8gZS5nLiwgcmVhY3QtcmVkdXgtcm91dGVyIHJlcXVpcmVzIGxvY2F0aW9uLnF1ZXJ5IHRvIGJlIGEga2V5LXZhbHVlIG9iamVjdCBmb3IgY29uc2lzdGVuY3kgd2l0aCBjbGllbnQtc2lkZSBiZWhhdmlvdXJcclxuICAgICAgICAgICAgbG9jYXRpb246IHVybC5wYXJzZShyZXF1ZXN0UGF0aEFuZFF1ZXJ5LCAvKiBwYXJzZVF1ZXJ5U3RyaW5nICovIHRydWUpLFxyXG4gICAgICAgICAgICBvcmlnaW46IHBhcnNlZEFic29sdXRlUmVxdWVzdFVybC5wcm90b2NvbCArICcvLycgKyBwYXJzZWRBYnNvbHV0ZVJlcXVlc3RVcmwuaG9zdCxcclxuICAgICAgICAgICAgdXJsOiByZXF1ZXN0UGF0aEFuZFF1ZXJ5LFxyXG4gICAgICAgICAgICBiYXNlVXJsOiAocmVxdWVzdFBhdGhCYXNlIHx8ICcnKSArICcvJyxcclxuICAgICAgICAgICAgYWJzb2x1dGVVcmw6IGFic29sdXRlUmVxdWVzdFVybCxcclxuICAgICAgICAgICAgZG9tYWluVGFza3M6IGRvbWFpblRhc2tDb21wbGV0aW9uUHJvbWlzZSxcclxuICAgICAgICAgICAgZGF0YTogY3VzdG9tRGF0YVBhcmFtZXRlclxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGFic29sdXRlQmFzZVVybCA9IHBhcmFtcy5vcmlnaW4gKyBwYXJhbXMuYmFzZVVybDsgLy8gU2hvdWxkIGJlIHNhbWUgdmFsdWUgYXMgcGFnZSdzIDxiYXNlIGhyZWY+XHJcbiAgICAgICAgLy8gT3BlbiBhIG5ldyBkb21haW4gdGhhdCBjYW4gdHJhY2sgYWxsIHRoZSBhc3luYyB0YXNrcyBpbnZvbHZlZCBpbiB0aGUgYXBwJ3MgZXhlY3V0aW9uXHJcbiAgICAgICAgbWFpbl8xLnJ1bigvKiBjb2RlIHRvIHJ1biAqLyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIE5vZGUgYnVnIHdoZXJlIG5hdGl2ZSBQcm9taXNlIGNvbnRpbnVhdGlvbnMgbG9zZSB0aGVpciBkb21haW4gY29udGV4dFxyXG4gICAgICAgICAgICAvLyAoaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlLXYwLngtYXJjaGl2ZS9pc3N1ZXMvODY0OClcclxuICAgICAgICAgICAgLy8gVGhlIGRvbWFpbi5hY3RpdmUgcHJvcGVydHkgaXMgc2V0IGJ5IHRoZSBkb21haW4tY29udGV4dCBtb2R1bGVcclxuICAgICAgICAgICAgYmluZFByb21pc2VDb250aW51YXRpb25zVG9Eb21haW4oZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlLCBkb21haW5bJ2FjdGl2ZSddKTtcclxuICAgICAgICAgICAgLy8gTWFrZSB0aGUgYmFzZSBVUkwgYXZhaWxhYmxlIHRvIHRoZSAnZG9tYWluLXRhc2tzL2ZldGNoJyBoZWxwZXIgd2l0aGluIHRoaXMgZXhlY3V0aW9uIGNvbnRleHRcclxuICAgICAgICAgICAgbWFpbl8xLmJhc2VVcmwoYWJzb2x1dGVCYXNlVXJsKTtcclxuICAgICAgICAgICAgLy8gQmVnaW4gcmVuZGVyaW5nLCBhbmQgYXBwbHkgYSB0aW1lb3V0XHJcbiAgICAgICAgICAgIHZhciBib290RnVuY1Byb21pc2UgPSBib290RnVuYyhwYXJhbXMpO1xyXG4gICAgICAgICAgICBpZiAoIWJvb3RGdW5jUHJvbWlzZSB8fCB0eXBlb2YgYm9vdEZ1bmNQcm9taXNlLnRoZW4gIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKFwiUHJlcmVuZGVyaW5nIGZhaWxlZCBiZWNhdXNlIHRoZSBib290IGZ1bmN0aW9uIGluIFwiICsgYm9vdE1vZHVsZS5tb2R1bGVOYW1lICsgXCIgZGlkIG5vdCByZXR1cm4gYSBwcm9taXNlLlwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdGltZW91dE1pbGxpc2Vjb25kcyA9IG92ZXJyaWRlVGltZW91dE1pbGxpc2Vjb25kcyB8fCBkZWZhdWx0VGltZW91dE1pbGxpc2Vjb25kczsgLy8gZS5nLiwgcGFzcyAtMSB0byBvdmVycmlkZSBhcyAnbmV2ZXIgdGltZSBvdXQnXHJcbiAgICAgICAgICAgIHZhciBib290RnVuY1Byb21pc2VXaXRoVGltZW91dCA9IHRpbWVvdXRNaWxsaXNlY29uZHMgPiAwXHJcbiAgICAgICAgICAgICAgICA/IHdyYXBXaXRoVGltZW91dChib290RnVuY1Byb21pc2UsIHRpbWVvdXRNaWxsaXNlY29uZHMsIFwiUHJlcmVuZGVyaW5nIHRpbWVkIG91dCBhZnRlciBcIiArIHRpbWVvdXRNaWxsaXNlY29uZHMgKyBcIm1zIGJlY2F1c2UgdGhlIGJvb3QgZnVuY3Rpb24gaW4gJ1wiICsgYm9vdE1vZHVsZS5tb2R1bGVOYW1lICsgXCInIFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKyAncmV0dXJuZWQgYSBwcm9taXNlIHRoYXQgZGlkIG5vdCByZXNvbHZlIG9yIHJlamVjdC4gTWFrZSBzdXJlIHRoYXQgeW91ciBib290IGZ1bmN0aW9uIGFsd2F5cyByZXNvbHZlcyBvciAnXHJcbiAgICAgICAgICAgICAgICAgICAgKyAncmVqZWN0cyBpdHMgcHJvbWlzZS4gWW91IGNhbiBjaGFuZ2UgdGhlIHRpbWVvdXQgdmFsdWUgdXNpbmcgdGhlIFxcJ2FzcC1wcmVyZW5kZXItdGltZW91dFxcJyB0YWcgaGVscGVyLicpXHJcbiAgICAgICAgICAgICAgICA6IGJvb3RGdW5jUHJvbWlzZTtcclxuICAgICAgICAgICAgLy8gQWN0dWFsbHkgcGVyZm9ybSB0aGUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIGJvb3RGdW5jUHJvbWlzZVdpdGhUaW1lb3V0LnRoZW4oZnVuY3Rpb24gKHN1Y2Nlc3NSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHN1Y2Nlc3NSZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgLyogY29tcGxldGlvbiBjYWxsYmFjayAqLyBmdW5jdGlvbiAoLyogY29tcGxldGlvbiBjYWxsYmFjayAqLyBlcnJvck9yTm90aGluZykge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3JPck5vdGhpbmcpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yT3JOb3RoaW5nLCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBubyBtb3JlIG9uZ29pbmcgZG9tYWluIHRhc2tzICh0eXBpY2FsbHkgZGF0YSBhY2Nlc3Mgb3BlcmF0aW9ucyksIHNvIHdlIGNhbiByZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgZG9tYWluIHRhc2tzIHByb21pc2Ugd2hpY2ggbm90aWZpZXMgdGhlIGJvb3QgY29kZSB0aGF0IGl0IGNhbiBkbyBpdHMgZmluYWwgcmVuZGVyLlxyXG4gICAgICAgICAgICAgICAgZG9tYWluVGFza0NvbXBsZXRpb25Qcm9taXNlUmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gSW5kaWNhdGUgdG8gdGhlIHByZXJlbmRlcmluZyBjb2RlIGJ1bmRsZWQgaW50byBNaWNyb3NvZnQuQXNwTmV0Q29yZS5TcGFTZXJ2aWNlcyB0aGF0IHRoaXMgaXMgYSBzZXJ2ZXJzaWRlIHJlbmRlcmluZ1xyXG4gICAgLy8gZnVuY3Rpb24sIHNvIGl0IGNhbiBiZSBpbnZva2VkIGRpcmVjdGx5LiBUaGlzIGZsYWcgZXhpc3RzIG9ubHkgc28gdGhhdCwgaW4gaXRzIGFic2VuY2UsIHdlIGNhbiBydW4gc29tZSBkaWZmZXJlbnRcclxuICAgIC8vIGJhY2t3YXJkLWNvbXBhdGliaWxpdHkgbG9naWMuXHJcbiAgICByZXN1bHRGdW5jWydpc1NlcnZlclJlbmRlcmVyJ10gPSB0cnVlO1xyXG4gICAgcmV0dXJuIHJlc3VsdEZ1bmM7XHJcbn1cclxuZXhwb3J0cy5jcmVhdGVTZXJ2ZXJSZW5kZXJlciA9IGNyZWF0ZVNlcnZlclJlbmRlcmVyO1xyXG5mdW5jdGlvbiB3cmFwV2l0aFRpbWVvdXQocHJvbWlzZSwgdGltZW91dE1pbGxpc2Vjb25kcywgdGltZW91dFJlamVjdGlvblZhbHVlKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHZhciB0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVqZWN0KHRpbWVvdXRSZWplY3Rpb25WYWx1ZSk7XHJcbiAgICAgICAgfSwgdGltZW91dE1pbGxpc2Vjb25kcyk7XHJcbiAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXNvbHZlZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc29sdmVkVmFsdWUpO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChyZWplY3RlZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpO1xyXG4gICAgICAgICAgICByZWplY3QocmVqZWN0ZWRWYWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBiaW5kUHJvbWlzZUNvbnRpbnVhdGlvbnNUb0RvbWFpbihwcm9taXNlLCBkb21haW5JbnN0YW5jZSkge1xyXG4gICAgdmFyIG9yaWdpbmFsVGhlbiA9IHByb21pc2UudGhlbjtcclxuICAgIHByb21pc2UudGhlbiA9IChmdW5jdGlvbiB0aGVuKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgcmVzb2x2ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXNvbHZlID0gZG9tYWluSW5zdGFuY2UuYmluZChyZXNvbHZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiByZWplY3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmVqZWN0ID0gZG9tYWluSW5zdGFuY2UuYmluZChyZWplY3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3JpZ2luYWxUaGVuLmNhbGwodGhpcywgcmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgIH0pO1xyXG59XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5mdW5jdGlvbiBfX2V4cG9ydChtKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5fX2V4cG9ydChyZXF1aXJlKFwiLi9QcmVyZW5kZXJpbmdcIikpO1xyXG4iLCJpbXBvcnQgeyBjcmVhdGVTZXJ2ZXJSZW5kZXJlciB9IGZyb20gJ2FzcG5ldC1wcmVyZW5kZXJpbmcnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlU2VydmVyUmVuZGVyZXIocGFyYW1zID0+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgY29uc3QgaHRtbCA9IGA8aDE+SGVsbG8gd29ybGQsIGZyb20gSlMhPC9oMT5cclxuICAgICAgICAgICAgPHA+Q3VycmVudCB0aW1lIGluIG5vZGU6ICR7IG5ldyBEYXRlKCkgfTwvcD5cclxuICAgICAgICAgICAgPHA+VVJMOiAke3BhcmFtcy5sb2NhdGlvbi5wYXRofTwvcD5cclxuICAgICAgICAgICAgPHA+ZGF0YSAoSXNBZG1pbmlzdHJhdG9yKTogJHtwYXJhbXMuZGF0YS5pc0FkbWluaXN0cmF0b3J9PC9wPlxyXG4gICAgICAgICAgICA8cD5OdW1iZXIgb2YgY29va2llczogJHtwYXJhbXMuZGF0YS5jb29raWVzLmxlbmd0aH08L3A+XHJcbiAgICAgICAgICAgIGA7XHJcbiAgICAgICAgcmVzb2x2ZSh7IGh0bWwgfSk7XHJcbiAgICB9KVxyXG59KTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==